<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="title">Misc</ui:define>

    <ui:define name="content">

        <h:form id="cadastro" rendered="#{not loginController.usuario.user}">
            <p:toolbar>
                <f:facet name="left">
                    <p:commandButton value="Pesquisar" icon="fa fa-search" />

                    <p:commandButton value="Novo" icon="fa fa-file-o" action="cadastro?faces-redirect=true" ajax="false"/>

                    <span class="ui-separator">
                        <span class="ui-icon pi pi-ellipsis-v" />
                    </span>


                    <p:commandButton type="button" title="Print" icon="fa fa-print" />
                </f:facet>
            </p:toolbar>

            <p:messages id="msg" closable="true" autoUpdate="true"/>
            <div class="ui-g ui-fluid">

                <div class="ui-g-12 ui-lg-6">
                    <h:form id="dados">
                        <p:dataTable id="table" value="#{plController.pesquisas}" reflow="true" var="pesquisa" emptyMessage="Sem registros">
                            <f:facet name="header">Pesquisas</f:facet>
                            <p:column headerText="Código">
                                <h:outputText value="#{pesquisa.id}"/>
                            </p:column>
                            <p:column headerText="Descrição">
                                <h:outputText value="#{pesquisa.descricao}"/>
                            </p:column>
                            <p:column headerText="Ativo">
                                <p:inputSwitch value="#{pesquisa.ativo}" disabled="true"/>
                            </p:column>
                            <p:column style="text-align: center">
                                <p:commandButton id="exportar" icon="fa fa-file-excel-o" process="@this" styleClass="teal-btn"
                                                 immediate="true" action="#{pesquisaController.exportarPesquisa()}" ajax="false">
                                    <f:setPropertyActionListener target="#{pesquisaController.pesquisa}" value="#{pesquisa}"/>
                                </p:commandButton>
                                <p:tooltip for="exportar" value="Exportar dados"/>
                            </p:column>
                            <p:column style="text-align: center">
                                <h:outputLink value="cadastro.xhtml">
                                    <p:button icon="fa fa-edit" />
                                    <f:param name="id" value="#{pesquisa.id}"/>
                                </h:outputLink>
                            </p:column>
                            <p:column style="text-align: center">
                                <p:commandButton  id="bt" icon="fa fa-trash" action="#{plController.remover()}" styleClass="red-btn"
                                                  update="cadastro:dados:table" process="@this">
                                    <f:setPropertyActionListener target="#{plController.pesquisa}" value="#{pesquisa}"/>
                                    <p:confirm header="Alerta" message="Excluir a pesquisa remove todas as perguntas associadas a ela. Confirma a exclusão?" icon="fa fa-exclamation-triangle" />
                                </p:commandButton>

                            </p:column>

                        </p:dataTable>

                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="fa fa-check" />
                            <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="fa fa-times" />
                        </p:confirmDialog>
                    </h:form>
                </div>
            </div>

        </h:form>    
    </ui:define>

</ui:composition>